<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first Three.js app</title>
		<link rel="stylesheet" href="css/style.css">

	</head>
	<body>

	<canvas id="canvas"></canvas>

		<script src="scripts/three.js"></script>
		<script>
			var canvas = document.getElementById('canvas');
			var ctx = canvas.getContext('2d');
			var width = canvas.width = window.innerWidth;
			var height = canvas.height = window.innerHeight;
			var particles = [];
			var colors = ['#029DAF', '#E5D599', '#FFC219', '#F07C19', '#E32551'];
			var gravity = 0.04;

			function initParticles(){
				for(var i = 0; i<200; i++){
					setTimeout(createParticle, 20*i, i);
				}
			};


			function Particle(x, y, vx, vy, size, color, opacity){
				function reset(){
					x= width*0.5;
					y = height*0.5;
					opacity = 0.5 + Math.random()*0.5;
					vx = -2+Math.random()*4;
					vy = Math.random()*-3;
				}
				this.update = function(){
					if(opacity - 0.005 > 0) opacity -=0.005;
					else reset();

					vy += gravity;
					x += vx;
					y += vy;
				}

				this.draw = function() {
					ctx.globalAlpha = opacity;
					ctx.fillStyle = color;
					ctx.fillRect(x, y, size, size);
				}
			}

			function createParticle(i) {
				var x = width*0.5;
				var y = height*0.5;

				var vx = -2+Math.random()*4;
				var vy = Math.random()*-3;

				var size = 5+Math.random()*5;
				var color = colors[i%colors.length];
				var opacity = 0.5 + Math.random()*0.5;
				var p = new Particle(x, y, vx, vy, size, color, opacity);

				particles.push(p);
				
			}

			function render(){
				ctx.clearRect(0, 0, width, height);

				for (var i = 0; i < particles.length; i++) {
					particles[i].update();
					particles[i].draw();
				};

				requestAnimationFrame(render);
			}

			window.addEventListener('resize', resize);
			function resize(){
				width = canvas.width = window.innerWidth;
				height = canvas.height = window.innerHeight;
			}

			initParticles();
			render();

		</script>
	</body>
</html>